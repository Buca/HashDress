var HashDress=function(){function h(){}function f(a,b,c,d){d=void 0===d?!0:d;void 0!==a&&a.attach(this);b=e.parsePath(b);this.string=null;this.list=[];this.parameters={};this.enabled=!0;this.entered=!1;this.triggerContext=this;this.onTrigger=c;this.disposed=!1;Object.assign(this,b);this.enabled&&d&&(b=e.parsePath(e.extractPath(window.location.hash)),!1!==this.validate(b)&&(this.onTrigger.bind(this.triggerContext)(b),this.dispatch("trigger",b)));this.on("enter",function(){this.entered=!0});this.on("leave",
function(){this.entered=!1})}function k(a,b,c,d){d=void 0===d?!0:d;void 0!==a&&a.attach(this);this.name=b;this.value=void 0;this.enabled=!0;this.entered=!1;this.triggerContext=this;this.onTrigger=c;this.disposed=!1;this.enabled&&d&&(a=e.parseQuery(e.extractQuery(window.location.hash,this.name)),a=this.validate(a),!1!==a&&this.trigger(a))}function l(){this.hash={current:{string:null},enabled:!0,deltaTrigger:!1};this.paths={current:{string:"",list:[],parameters:{}},list:[],enabled:!0,deltaTrigger:!1};
this.queries={current:{string:"",list:[]},enabled:!0,deltaTrigger:!1,list:[]};this.fragment={current:{string:"",value:""},deltaTrigger:!1};this.Path=f.bind(null,this);this.Query=k.bind(null,this);this.Router=l;this.on("hash-change",function(a){this.hash.current.string=a.string;!this.paths.enabled||this.paths.deltaTrigger&&a.paths.string===this.paths.current.string||this.dispatch("path-change",a.path);!this.queries.enabled||this.queries.deltaTrigger&&a.queries.string===this.queries.current.string||
this.dispatch("queries-change",a.queries);!this.fragment.enabled||this.fragment.deltaTrigger&&a.fragment.string===this.fragment.current.string||this.dispatch("fragment-change",a.fragment)});this.on("path-change",function(a){this.paths.current=a;this.triggerPaths(a)});this.on("queries-change",function(a){this.queries.current=a;this.triggerQueries(a)});this.on("fragment-change",function(a){this.fragment.current=a;this.triggerFragment(a)});var a=function(){if(this.hash.enabled){var a=e.parseHash(window.location.hash);
!this.hash.enabled||this.hash.deltaTrigger&&a.string===this.hash.current.string||this.dispatch("hash-change",a)}}.bind(this);window.addEventListener("hashchange",a);a()}var e={history:function(a,b){"replace"===a?history.replaceState(null,null,b):"push"===a&&history.pushState(null,null,b)},isString:function(a){return"string"===typeof a},isArray:function(a){return Array.isArray(a)},parseHash:function(a){var b=e.parsePath(e.extractPath(a)),c=e.parseQueries(e.extractQueries(a));a=e.parseFragment(e.extractFragment(a));
return{string:b.string+c.string+a.string,path:b,queries:c,fragment:a}},parsePath:function(a){if(!e.isString(a))return a;var b={string:a,list:[]};a=a.split("/");for(var c=0;c<a.length;c++){b.list[c]={string:a[c],list:a[c].split("-"),parameters:{},listIndex:c};for(var d=0;d<b.list[c].list.length;d++)":"===b.list[c].list[d][0]&&(b.list[c].parameters[b.list[c].list[d].substring(1)]={listIndex:d,validate:void 0})}return b},extractPath:function(a){var b=a.indexOf("?",2),c=-1===b?a.indexOf("#",2):-1;-1!==
b?a=a.substring(0,b):-1!==c&&(a=a.substring(0,c));return a},replacePath:function(a,b){var c=a.indexOf("?",2);if(-1!==c)return b+a.substring(c);c=a.indexOf("#",2);return-1!==c?b+a.substring(c):b},validatePaths:function(a,b){b=e.parsePath(b);for(var c,d,m,h={},f=0;f<a.list.length;f++){c=a.list[f];c.list[c.list.length-1]&&(d=b.list[f]);for(var g=0;g<c.list.length;g++){if(g===c.list.length-1&&"*"===c.list[g][c.list[g].length-1])return h;if(":"!==c.list[g][0]&&c.list[g]!==d.list[g])return!1;if(":"===c.list[g][0])if(m=
c.list[g].substring(0),void 0===c.list[g].parameters[m].validate||c.list[g].parameters[m].validate(d.list[g]))h[m]=d.list[g];else return!1}}return h},parseQueries:function(a){if(!e.isString(a))return a;var b={string:a,list:[]};if(""===a)return b;a=a.substring(1).split("&");for(var c=0;c<a.length;c++){var d=a[c].split("=");b.list[c]={string:a[c],name:d[0],value:d[1],listIndex:c}}return b},extractQueries:function(a){var b=a.indexOf("?",2);if(-1!==b){var c=a.indexOf("#",2);return-1!==c?a.substring(b,
c):a.substring(b)}return""},parseQuery:function(a){if(!e.isString(a))return a;var b=a.split("=");return{string:a,name:b[0],value:b[1]}},validateQuery:function(a,b){b=e.parseQuery(b);return void 0===b?!1:b.name===a.name?(void 0!==a.valueParser&&(b.value=a.valueParser(b.value)),b):!1},extractQuery:function(a,b){var c=e.extractQueries(a);c=e.parseQueries(c);for(var d=0;d<c.list.length;d++)if(c.list[d].name===b)return c.list[d]},parseFragment:function(a){return{string:a,value:a.substring(1)}},extractFragment:function(a){var b=
a.indexOf("#",2);return-1!==b?a.substring(b):""}};h.prototype={constructor:h,addEventListener:function(a,b,c){void 0===this.listeners&&(this.listeners={});void 0===this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push({listener:b,context:void 0===c?this:c})},on:function(a,b,c){this.addEventListener(a,b,void 0===c?this:c)},removeEventListener:function(a,b){if(void 0===this.listeners||void 0===this.listeners[a])return!1;for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].listener===
b&&this.listeners[a].splice(c,1)},clearEventListeners:function(){void 0!==this.listeners&&(this.listeners=void 0)},dispatch:function(a,b){if(void 0===this.listeners||void 0===this.listeners[a])return!1;for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].listener.bind(this.listeners[a][c].context)(b)}};f.prototype=Object.assign(Object.create(h.prototype),{constructor:f,trigger:function(a,b){b=void 0===b?this.triggerContext:b;a=e.parsePath(a);this.onTrigger.bind(b)(a);
this.dispatch("trigger",a);return this},validate:function(a){return e.validatePaths(this,a)},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},dispose:function(){this.clearEventListeners();for(var a in this)this[a]=void 0;this.disposed=!0}});k.prototype=Object.assign(Object.create(h.prototype),{constructor:k,trigger:function(a,b){b=void 0===b?this.triggerContext:b;a=e.parseQuery(a);this.value=a.value;this.onTrigger.bind(b)(a);this.dispatch("trigger",a);
return this},validate:function(a){return e.validateQuery(this,a)},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},dispose:function(a){this.clearEventListeners();for(var b in this)this[b]=void 0;this.disposed=!0}});l.prototype=Object.assign(Object.create(h.prototype),{constructor:l,setHash:function(a,b,c){b=void 0===b?"replace":b;c=void 0===c?!0:c;a=e.parseHash(a);e.history(b,a.string);c&&this.hash.enabled&&(!this.hash.enabled||this.hash.deltaTrigger&&
a.string===this.hash.current.string||this.dispatch("hash-change",a));return this},getHash:function(){return this.hash.current.string},enable:function(){this.hash.enabled=!0;return this},disable:function(){this.hash.enabled=!1;return this},triggerPaths:function(a){a=e.parsePath(a);if(!this.paths.enabled)return this;for(var b=this.paths.list.length-1;0<=b;b--){var c=this.paths.list[b];c.disposed&&this.paths.list.splice(b,1);var d=c.validate(a);!1!==d?(d=Object.assign(d,a),c.trigger(d),c.entered||c.dispatch("enter",
d)):c.entered&&c.dispatch("leave",a)}return this},setPath:function(a,b,c){b=void 0===b?"replace":b;c=void 0===c?!0:c;a=e.parsePath(a);e.history(b,a.string+this.queries.current.string+this.fragment.current.string);c&&this.triggerPaths(a);return this},getPath:function(){return this.paths.current.string},enablePaths:function(){this.paths.enabled=!0;return this},disablePaths:function(){this.paths.enabled=!1;return this},triggerQueries:function(a){if(!this.queries.enabled)return this;a=e.parseQueries(a);
for(var b=0;b<a.list.length;b++)for(var c=this.queries.list.length-1;0<=c;c--){var d=this.queries.list[c];d.disposed&&this.paths.list.splice(c,1);var f=d.validate(a.list[b]);!1!==f&&(f=Object.assign(f,a.list[b]),d.trigger(f))}return this},setQueries:function(a,b,c){b=void 0===b?"replace":b;c=void 0===c?!0:c;a=e.parseQueries(path);e.history(b,this.paths.current.string+a.string+this.fragment.current.string);c&&this.triggerQueries(a)},getQueries:function(){return this.queries.current.string},triggerFragment:function(a){if(this.fragment.enabled)if(a=
e.parseFragment(a),this.fragment.current=a,"complete"===document.readyState){var b=document.getElementById(a.value);null!==b&&b.scrollIntoView()}else window.addEventListener("DOMContentLoaded",function(){var b=document.getElementById(a);null!==b&&b.scrollIntoView()})},setFragment:function(a,b,c){b=void 0===b?"replace":b;c=void 0===c?!0:c;a=e.parseFragment(a);e.history(b,this.paths.current.string+this.queries.current.string+a.string);c&&this.triggerFragment(path)},getFragment:function(){return this.fragment.current.string},
detach:function(a){void 0===a?(this.detach(this.paths.list),this.detach(this.queries.list)):e.isArray(a)||(a=[a]);if(e.isArray(a))for(var b,c=0;c<a.length;c++)if(a[c]instanceof f)b=this.paths.list.indexOf(a[c]),-1!==b&&(this.paths.splice(b,1),a.detach(this,!1));else if(a instanceof k)b=this.queries.list.indexOf(a[c]),-1!==b&&this.queries.splice(b,1);else throw TypeError("The argument needs to be an instance of Path or Query or array of Paths and Queries.");},attach:function(a){e.isArray(a)||(a=[a]);
if(e.isArray(a))for(var b,c=0;c<a.length;c++)if(a[c]instanceof f)b=this.paths.list.indexOf(a[c]),-1===b&&this.paths.list.push(a[c]);else if(a[c]instanceof k)b=this.queries.list.indexOf(a[c]),-1===b&&this.queries.list.push(a[c]);else throw TypeError("The argument needs to be an instance of Path or Query or array of Paths and Queries.");},dispose:function(a){a=void 0===a?!1:a;this.clearEventListeners();a&&this.detach();for(var b in this)this[b]=void 0}});window.HashDress=new l}();
